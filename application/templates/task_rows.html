{% for task in tasks %}
<tr id="task-row" 
{% if loop.last %} 
hx-get="/get_tasks/?page={{ page + 1 }}" hx-trigger="revealed" 
hx-swap="afterend" hx-target="this" 
{% endif %}>
<div id="task-cells">
    <td>{{ task.task_id }}</td>
    <td>{{ task.task_title }}</td>
    <td>{{ task.task_description }}</td>
    <td>{{ task.task_created_at }}</td>
    <td>{{ task.task_due_time }}</td>
    <td>{{ task.task_priority }}</td>
    <td>{{ task.task_status }}</td>
    <td>{{ task.task_tags }}</td>
    <td>{{ task.task_scheduled_time }}</td>
    <td>{{ task.task_updated_at }}</td>
    <td>{{ task.completed_at }}</td>
    <td><button hx-post="{{ url_for('main.edit_task', task_id=task.task_id) }}" hx-target="closest tr" class="btn btn-primary">Edit Task</button></td>
    <td class="button-cell"><button id="delete-task-button{{ task.task_id }}" hx-delete="{{ url_for('main.delete_task', task_id=task.task_id) }}" 
        hx-target="closest tr" class="btn btn-danger delete-button" 
        hx-confirm="Are you sure you want to delete this task?&#10;&#10;{{ task.task_title }}" 
        hx-swap="outerHTML swap:1s"
        hx-on::after-request="htmx.trigger('#flash-messages', 'flashUpdate')">
        Delete Task
        </button></td>
</tr>
</div>
{% endfor %}
<script>
    function toggleConfirm(checked) {
        const buttons = document.querySelectorAll('.delete-button');
        buttons.forEach(button => {
            if (checked) {
                button.setAttribute('hx-confirm', 'Are you sure you want to delete this task?');
            } else {
                button.removeAttribute('hx-confirm');
            }
        });
    }
    </script>